var q=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports);var _=q((Gt,ot)=>{var kt=require("fs"),Q=require("path");function bt(o,t,r={}){if(r[t]){let e=r[t];return Q.isAbsolute(e)?e:Q.resolve(o,e)}return Q.resolve(o,t)}function vt(o,t="",r={}){let e=o,S=/import\s+\{([\s\S]*?)\}\s+from\s+['"](.*?)['"]/g;if(e=e.replace(S,(n,l,a)=>l.split(",").map(g=>{if(g=g.trim(),!g)return"";if(g.includes(" as ")){let[R,C]=g.split(" as ").map(j=>j.trim());return`var ${C} = window.${R};`}else return`var ${g} = window.${g};`}).filter(Boolean).join(`
`)),e=e.replace(/import\s+['"].*?['"]/g,""),e=e.replace(/import\s+.*?from\s+['"].*?['"]/g,""),e=e.replace(/export\s+const\s+(\w+)/g,"window.$1"),e=e.replace(/export\s+var\s+(\w+)/g,"window.$1"),e=e.replace(/export\s+let\s+(\w+)/g,"window.$1"),e=e.replace(/export\s+function\s+(\w+)/g,"window.$1 = function $1"),e=e.replace(/export\s+class\s+(\w+)/g,"window.$1 = class $1"),/export\s+default\s+\{/.test(e)&&(e=e.replace(/export\s+default\s+\{/,"var __ltng_default_export = {"),e+=`
Object.assign(window, __ltng_default_export);`),e=e.replace(/export\s+default\s+(\w+)/g,"window.default = $1"),e=e.replace(/export\s+\{([\s\S]*?)\}/g,(n,l)=>l.split(",").map(a=>{if(a=a.trim(),!a)return"";if(a.includes(" as ")){let[u,g]=a.split(" as ").map(R=>R.trim());return`window.${g} = ${u};`}else return`window.${a} = ${a};`}).join(`
`)),e=e.replace(/export\s+\*\s+from\s+['"].*?['"]/g,""),r.stripLoadCSS&&(e=e.replace(/window\.loadCSS\(new URL\(.*?, import\.meta\.url\)\.href\)/g,"")),t&&t!=="inline"){let n="file://"+(t.startsWith("/")?"":"/")+t;e=e.replace(/import\.meta/g,`({ url: '${n}' })`)}else e=e.replace(/import\.meta/g,"({ url: 'file:///unknown' })");return e}function Rt(o){return o.replace(/\/\*[\s\S]*?\*\//g,"").replace(/^\s*\/\/.*$/gm,"").split(`
`).map(t=>t.trim()).filter(t=>t.length>0).join(`
`)}ot.exports={resolvePath:bt,transpile:vt,minify:Rt}});var Y=q((_t,ct)=>{var B=require("fs"),X=require("path"),{transpile:Ut}=_();function jt(o,t,r){let{srcDir:e,rootDir:S}=r,n=o.url==="/"?"/index.html":o.url;if(n.includes("..")){t.writeHead(403),t.end("Forbidden");return}let l=X.join(e,n);if(!B.existsSync(l)){let a=X.join(S,n);B.existsSync(a)&&(l=a)}if(B.existsSync(l)){let a=X.extname(l),u=B.readFileSync(l);a===".js"||a===".mjs"?t.writeHead(200,{"Content-Type":"text/javascript"}):a===".html"?t.writeHead(200,{"Content-Type":"text/html"}):a===".css"?t.writeHead(200,{"Content-Type":"text/css"}):t.writeHead(200,{"Content-Type":"text/plain"}),t.end(u)}else t.writeHead(404),t.end("Not found")}ct.exports=jt});var at=q((Bt,lt)=>{var F=class{constructor(){this.childNodes=[]}appendChild(t){if(t)return this.childNodes.push(t),t.parentNode=this,t}remove(){if(this.parentNode){let t=this.parentNode.childNodes.indexOf(this);t>-1&&this.parentNode.childNodes.splice(t,1)}}},P=class extends F{constructor(t){super(),this.textContent=t}toString(){return this.textContent}},N=class extends F{constructor(t){super(),this.tagName=t.toLowerCase(),this.attributes={},this.style={},this.classList={add:(...r)=>{let e=(this.attributes.class||"").split(" ").filter(Boolean);this.attributes.class=[...new Set([...e,...r])].join(" ")}}}setAttribute(t,r){this.attributes[t]=String(r)}getAttribute(t){return this.attributes[t]}addEventListener(){}closest(){return null}toString(){let t=Object.entries(this.attributes).map(([n,l])=>` ${n}="${l}"`).join(""),r=Object.entries(this.style).map(([n,l])=>`${n.replace(/[A-Z]/g,a=>"-"+a.toLowerCase())}:${l}`).join(";"),e=r?` style="${r}"`:"";if(["img","input","br","hr","meta","link"].includes(this.tagName))return`<${this.tagName}${t}${e} />`;let S=this.childNodes.map(n=>n.toString()).join("");return`<${this.tagName}${t}${e}>${S}</${this.tagName}>`}},E=class extends N{constructor(){super("body")}},tt=class extends N{constructor(){super("head")}},J=class extends N{constructor(){super("link")}set href(t){this.setAttribute("href",t)}get href(){return this.getAttribute("href")}set rel(t){this.setAttribute("rel",t)}get rel(){return this.getAttribute("rel")}},z=class extends N{constructor(t){super(t)}},et=class{constructor(){this.head=new tt,this.body=new E}createElement(t){return t.toLowerCase()==="body"?this.body:t.toLowerCase()==="link"?new J:new N(t)}createTextNode(t){return new P(t)}querySelector(t){if(t.startsWith("link[href=")){let r=t.match(/href=["'](.*?)["']/)[1];return this.head.childNodes.find(e=>e.tagName==="link"&&e.attributes.href===r)||null}return null}getElementById(t){let r=n=>{if(n.attributes&&n.attributes.id===t)return n;if(n.childNodes)for(let l of n.childNodes){let a=r(l);if(a)return a}return null},e=r(this.body);return e||r(this.head)}},st=class{constructor(){this.document=new et,this.console=console,this.HTMLElement=N,this.HTMLBodyElement=E,this.HTMLUnknownElement=z,this.Node=F,this.TextNode=P,this.localStorage={getItem:()=>null,setItem:()=>{},removeItem:()=>{},clear:()=>{}},this.crypto={getRandomValues:t=>{for(let r=0;r<t.length;r++)t[r]=Math.floor(Math.random()*256);return t}}}};function Wt(){return new st}lt.exports={createWindow:Wt,HTMLElement:N,HTMLBodyElement:E,HTMLUnknownElement:z,Node:F,TextNode:P,HTMLLinkElement:J}});var nt=q((Jt,ut)=>{var D=require("fs"),H=require("path"),k=require("vm"),{transpile:dt,resolvePath:rt}=_(),Ct=at();function ht(o,t){let r=D.readFileSync(o,"utf8"),e=Ct.createWindow(),S=e.document,n=e;n.window=n,n.global=n,n.console=console,n.setTimeout=setTimeout,n.clearTimeout=clearTimeout,n.URL=URL,k.createContext(n);let l=/<script\b[^>]*>([\s\S]*?)<\/script>/gmi,a=/src=["'](.*?)["']/,u=/type=["'](.*?)["']/,g={},R=/<script\b[^>]*type=["']importmap["'][^>]*>([\s\S]*?)<\/script>/gmi,C;for(;(C=R.exec(r))!==null;)try{let p=JSON.parse(C[1]);p.imports&&(g={...g,...p.imports})}catch(p){console.error("Failed to parse import map",p)}let j=new Set;function b(p){if(j.has(p))return;if(console.log(`Loading module: ${p}`),j.add(p),!D.existsSync(p)){console.error(`Module not found: ${p}`);return}let v=D.readFileSync(p,"utf8"),s=/(?:import|export)\s+(?:[\s\S]*?)\s+from\s+['"](.*?)['"]|import\s+['"](.*?)['"]/g,i;for(;(i=s.exec(v))!==null;){let h=i[1]||i[2];if(h){let m=rt(H.dirname(p),h,g);b(m)}}let f=`(function(){
${dt(v,p)}
})();`;try{k.runInContext(f,n)}catch(h){console.error(`Error running module ${p}:`,h)}}let x;for(;(x=l.exec(r))!==null;){let p=x[0],v=u.exec(p),s=v?v[1]:"";if(s==="importmap")continue;let i=a.exec(p),d=x[1];if(i){let f=i[1],h=rt(H.dirname(o),f,g);if(s==="module")b(h);else if(D.existsSync(h)){let m=D.readFileSync(h,"utf8");try{k.runInContext(m,n)}catch(y){console.error(`Error running script ${h}:`,y)}}}else if(d.trim())if(s==="module"){let f=/(?:import|export)\s+(?:[\s\S]*?)\s+from\s+['"](.*?)['"]|import\s+['"](.*?)['"]/g,h;for(;(h=f.exec(d))!==null;){let I=h[1]||h[2];if(I){let W=rt(H.dirname(o),I,g);b(W)}}let y=`(function(){
${dt(d,"inline")}
})();`;try{k.runInContext(y,n)}catch(I){console.error("Error running inline module:",I)}}else try{k.runInContext(d,n)}catch(f){console.error("Error running inline script:",f)}}let U=/(<body\b[^>]*>)([\s\S]*?)(<\/body>)/i,w=U.exec(r),M="";if(w){let p=w.index,v=p+w[0].length,s,i=/<script\b[^>]*>([\s\S]*?)<\/script>/gmi;for(;(s=i.exec(r))!==null;)s.index>=p&&s.index<v&&(M+=s[0]+`
`)}if(w){let p=w[1],v=w[3],s=S.body.childNodes.map(d=>d.toString()).join(""),i=`${p}${s}${M}${v}`;r=r.replace(U,()=>i)}let O=/(<head\b[^>]*>)([\s\S]*?)(<\/head>)/i,A=O.exec(r);if(A){let p=A[1],v=A[2],s=A[3],i=S.head.childNodes.map(f=>f.toString()).join(""),d=`${p}${v}${i}${s}`;r=r.replace(O,()=>d)}return r}function Nt(o,t,r){let{srcDir:e,rootDir:S}=r,n=o.url==="/"?"/index.html":o.url;if(n.endsWith(".html")||n==="/"){let l=H.join(e,n==="/"?"index.html":n);if(D.existsSync(l)||(l=H.join(S,n)),D.existsSync(l))try{let a=ht(l,S),u=/["'](file:\/\/.*?)["']/g;a=a.replace(u,(g,R)=>{try{let C=new URL(R),j=H.normalize(C.pathname);if(j.startsWith(e)){let b=H.relative(e,j);return`"${b.startsWith("/")?b:"/"+b}"`}if(j.startsWith(S)){let b=H.relative(S,j);return`"${b.startsWith("/")?b:"/"+b}"`}return g}catch{return g}}),t.writeHead(200,{"Content-Type":"text/html"}),t.end(a)}catch(a){console.error(a),t.writeHead(500),t.end("SSR Error")}else t.writeHead(404),t.end("Not found")}else Y()(o,t,r)}ut.exports={handleSSR:Nt,renderFile:ht}});var ft=q((zt,pt)=>{var $=require("fs"),c=require("path"),{renderFile:Tt}=nt(),{resolvePath:G}=_();function At(o){let{srcDir:t,distDir:r,rootDir:e}=o;console.log(`Building SSG from ${t} to ${r}...`),$.existsSync(r)||$.mkdirSync(r,{recursive:!0}),$.readdirSync(t).filter(n=>n.endsWith(".html")).forEach(n=>{console.log(`Rendering ${n}...`);let l=c.join(t,n);try{let A=function(s){if(!$.existsSync(s))return;let i=$.readFileSync(s,"utf8"),d=/(?:import|export)\s+(?:[\s\S]*?)\s+from\s+['"](.*?)['"]|import\s+['"](.*?)['"]/g,f;for(;(f=d.exec(i))!==null;){let m=f[1]||f[2];if(m&&!m.startsWith("http")){let y=G(c.dirname(s),m);console.log(`Scanned dependency: ${m} -> ${y}`),x.has(y)||(x.add(y),A(y))}}let h=/new\s+URL\s*\(\s*['"](.*?)['"]\s*,\s*import\.meta\.url\s*\)/g;for(;(f=h.exec(i))!==null;){let m=f[1];if(m&&!m.startsWith("http")){let y=G(c.dirname(s),m);console.log(`Scanned asset: ${m} -> ${y}`),x.has(y)||x.add(y)}}};var a=A;let u=Tt(l,e);console.log(`[SSG] Initial HTML length: ${u.length}`);let g=/["'](file:\/\/.*?)["']/g;u=u.replace(g,(s,i)=>{try{let f=new URL(i).pathname,h,m=c.relative(t,f);if(!m.startsWith("..")&&!c.isAbsolute(m))h=c.join(r,m);else{let K=c.relative(e,f);h=c.join(r,K)}let I=c.dirname(c.join(r,n)),W=c.relative(I,h);return W.startsWith(".")||(W="./"+W),`"${W}"`}catch{return s}}),console.log(`[SSG] HTML length after file:// URL rewrite: ${u.length}`);let R=(s,i,d)=>{if(!s||s.startsWith("http")||s.startsWith("data:")||s.startsWith("/")||s.startsWith("#"))return s;try{let f=G(c.dirname(c.join(t,i)),s),h,m=c.relative(t,f);if(!m.startsWith("..")&&!c.isAbsolute(m))h=c.join(d,m);else{let K=c.relative(e,f);h=c.join(d,K)}let I=c.dirname(c.join(d,i)),W=c.relative(I,h);return W.startsWith(".")||(W="./"+W),W}catch{return s}},C=/src=["'](.*?)["']/g;u=u.replace(C,(s,i)=>i.startsWith("http")||i.startsWith("//")||i.startsWith("data:")?s:`src="${R(i,n,r)}"`),console.log(`[SSG] HTML length after src rewrite: ${u.length}`);let j=/href=["'](.*?)["']/g;u=u.replace(j,(s,i)=>i.startsWith("http")||i.startsWith("//")||i.startsWith("#")||i.startsWith("data:")?s:`href="${R(i,n,r)}"`),console.log(`[SSG] HTML length after href rewrite: ${u.length}`);let b=/<script\b[^>]*type=["']importmap["'][^>]*>([\s\S]*?)<\/script>/gmi;u=u.replace(b,(s,i)=>{try{let d=JSON.parse(i);return d.imports&&Object.keys(d.imports).forEach(f=>{let h=d.imports[f];!h.startsWith("http")&&!h.startsWith("//")&&(d.imports[f]=R(h,n,r))}),`<script type="importmap">
${JSON.stringify(d,null,2)}
</script>`}catch{return s}}),console.log(`[SSG] HTML length after importmap rewrite: ${u.length}`),$.writeFileSync(c.join(r,n),u);let x=new Set,U=/<(?:script|link)\b[^>]*?(?:src|href)=["'](.*?)["'][^>]*>/gmi,w;for(;(w=U.exec(u))!==null;){let s=w[1];s&&!s.startsWith("http")&&x.add(s)}let M=/<script\b[^>]*type=["']importmap["'][^>]*>([\s\S]*?)<\/script>/gmi,O=$.readFileSync(l,"utf8");for(;(w=M.exec(O))!==null;)try{let s=JSON.parse(w[1]);s.imports&&Object.values(s.imports).forEach(i=>{i.startsWith("http")||x.add(i)})}catch{}x.clear();let p=/<(?:script|link)\b[^>]*?(?:src|href)=["'](.*?)["'][^>]*>/gmi;for(;(w=p.exec(O))!==null;){let s=w[1];if(s&&!s.startsWith("http")){let i=G(c.dirname(l),s);x.add(i)}}for(;(w=M.exec(O))!==null;)try{let s=JSON.parse(w[1]);s.imports&&Object.values(s.imports).forEach(i=>{if(!i.startsWith("http")){let d=G(c.dirname(l),i);x.add(d)}})}catch{}let v=Array.from(x);x.clear();for(let s of v)$.existsSync(s)&&(x.add(s),(s.endsWith(".js")||s.endsWith(".mjs"))&&A(s));for(let s of x)try{let i,d=c.relative(t,s);if(!d.startsWith("..")&&!c.isAbsolute(d))i=c.join(r,d);else{let h=c.relative(e,s);i=c.join(r,h)}if($.existsSync(s)){let h=c.dirname(i);$.existsSync(h)||$.mkdirSync(h,{recursive:!0}),$.copyFileSync(s,i),console.log(`Copied ${c.relative(e,s)} to ${c.relative(e,i)}`)}}catch(i){console.error(`Failed to copy asset ${s}`,i)}}catch(u){console.error(`Failed to render ${n}`,u)}}),console.log("SSG Build complete.")}function It(o,t,r){let{distDir:e}=r,S=o.url==="/"?"/index.html":o.url,n=c.join(e,S);if($.existsSync(n)){let l=c.extname(n),a=$.readFileSync(n),u=l===".html"?"text/html":l===".js"||l===".mjs"?"text/javascript":l===".css"?"text/css":"text/plain";t.writeHead(200,{"Content-Type":u}),t.end(a)}else t.writeHead(404),t.end("Not found")}pt.exports={buildSSG:At,handleSSGServe:It}});var Ht=require("http"),it=require("path"),Dt=Y(),{handleSSR:Lt}=nt(),{buildSSG:Ot,handleSSGServe:Ft}=ft(),L=process.argv.slice(2),mt=L.includes("--build"),Vt=L.includes("--serve"),Mt=L.includes("--b&s"),gt=L.find(o=>o.startsWith("--mode=")),T=gt?gt.split("=")[1]:"csr",St=L.find(o=>o.startsWith("--port=")),Z=St?parseInt(St.split("=")[1],10):3e3,xt=L.find(o=>o.startsWith("--src=")),yt=xt?it.resolve(xt.split("=")[1]):process.cwd(),wt=L.find(o=>o.startsWith("--dist=")),$t=wt?it.resolve(wt.split("=")[1]):it.join(process.cwd(),"dist"),qt=process.cwd(),V={srcDir:yt,distDir:$t,rootDir:qt,port:Z,mode:T};console.log(`Mode: ${T}`);console.log(`Source: ${yt}`);console.log(`Dist: ${$t}`);console.log(`Port: ${Z}`);(mt||Mt&&T==="ssg")&&(T==="ssg"?(Ot(V),mt&&process.exit(0)):(console.error("Build is only supported for SSG mode."),process.exit(1)));var Pt=Ht.createServer((o,t)=>{try{T==="csr"?Dt(o,t,V):T==="ssr"?Lt(o,t,V):T==="ssg"?Ft(o,t,V):(t.writeHead(500),t.end(`Unknown mode: ${T}`))}catch(r){console.error("Server Error:",r),t.writeHead(500),t.end("Internal Server Error")}});Pt.listen(Z,()=>{console.log(`Server running in ${T.toUpperCase()} mode at http://localhost:${Z}`)});
